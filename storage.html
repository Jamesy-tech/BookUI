<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>index.html</title>
</head>
<body>
<script>
  const ALLOWED_ORIGINS = ["*"];

  window.addEventListener("message", (e) => {
    if (
      ALLOWED_ORIGINS[0] !== "*" &&
      !ALLOWED_ORIGINS.includes(e.origin)
    ) return;

    const { type, key, value, id } = e.data || {};

    if (type === "get") {
      e.source.postMessage({
        id,
        value: localStorage.getItem(key)
      }, e.origin);
    }

    if (type === "set") {
      localStorage.setItem(key, value);
      e.source.postMessage({ id, ok: true }, e.origin);
    }

    if (type === "remove") {
      localStorage.removeItem(key);
      e.source.postMessage({ id, ok: true }, e.origin);
    }
  });
</script>
</body>
</html>
